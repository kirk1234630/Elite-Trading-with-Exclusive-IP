<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Trading Analytics - EA Style</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://s3.tradingview.com/tv.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: linear-gradient(135deg, #1a1a3e 0%, #16213e 50%, #0f3460 100%); color: #fff; font-family: -apple-system, sans-serif; min-height: 100vh; }

        .header { background: rgba(20, 20, 50, 0.95); backdrop-filter: blur(10px); border-bottom: 2px solid #00d4ff; padding: 1.2rem 2rem; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
        .logo { font-size: 1.8em; font-weight: 900; background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; cursor: pointer; }
        .search-bar { flex: 1; max-width: 500px; margin: 0 2rem; display: flex; align-items: center; background: rgba(30, 30, 60, 0.8); border: 2px solid #444; border-radius: 10px; padding: 0.8rem 1rem; gap: 0.8rem; }
        .search-bar input { flex: 1; background: transparent; border: none; color: #fff; outline: none; }
        .search-bar button { background: linear-gradient(135deg, #7c3aed 0%, #06b6d4 100%); border: none; color: white; padding: 0.7rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 700; }

        .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }
        .page { display: none; }
        .page.active { display: block; }

        .btn-large { padding: 1rem 2rem; border: none; border-radius: 12px; font-size: 1.1em; font-weight: 700; cursor: pointer; display: flex; align-items: center; gap: 0.8rem; justify-content: center; }
        .btn-refresh { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; }
        .btn-brief { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; }
        .btn-newsletter { background: linear-gradient(135deg, #ec4899 0%, #db2777 100%); color: white; }
        .btn-back { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; width: 100%; margin-top: 2rem; }
        .action-buttons { display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; flex-wrap: wrap; }

        /* AI CHAT */
        .ai-chat-toggle { position: fixed; bottom: 30px; right: 30px; width: 70px; height: 70px; background: linear-gradient(135deg, #7c3aed 0%, #06b6d4 100%); border: none; border-radius: 50%; color: white; font-size: 1.8em; cursor: pointer; z-index: 200; box-shadow: 0 8px 25px rgba(124, 58, 237, 0.4); transition: all 0.3s; }
        .ai-chat-toggle:hover { transform: scale(1.1); }
        .ai-chat-toggle.hidden { opacity: 0; pointer-events: none; }
        .ai-chat-widget { position: fixed; bottom: 120px; right: 30px; width: 420px; max-height: 600px; background: rgba(30, 30, 60, 0.98); border: 2px solid #00d4ff; border-radius: 15px; display: flex; flex-direction: column; z-index: 199; box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5); transform: scale(0.8); opacity: 0; pointer-events: none; transition: all 0.3s; }
        .ai-chat-widget.active { transform: scale(1); opacity: 1; pointer-events: all; }
        .ai-chat-header { background: linear-gradient(135deg, #7c3aed 0%, #06b6d4 100%); color: white; padding: 1.2rem; border-radius: 13px 13px 0 0; font-weight: 700; display: flex; justify-content: space-between; align-items: center; }
        .ai-messages { flex: 1; overflow-y: auto; padding: 1.2rem; display: flex; flex-direction: column; gap: 1rem; min-height: 300px; max-height: 400px; }
        .message { padding: 0.9rem 1.2rem; border-radius: 10px; max-width: 90%; word-wrap: break-word; font-size: 0.9em; line-height: 1.6; }
        .message.user { align-self: flex-end; background: linear-gradient(135deg, #7c3aed 0%, #06b6d4 100%); color: white; }
        .message.ai { align-self: flex-start; background: rgba(0, 212, 255, 0.15); color: #d1fae5; border: 1px solid #00d4ff; }
        .ai-input { display: flex; gap: 0.8rem; padding: 1.2rem; border-top: 1px solid #444; }
        .ai-input input { flex: 1; background: rgba(20, 20, 50, 0.8); border: 1px solid #444; color: white; padding: 0.8rem; border-radius: 8px; outline: none; }
        .ai-input button { background: linear-gradient(135deg, #7c3aed 0%, #06b6d4 100%); border: none; color: white; padding: 0.8rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 700; }

        /* STOCK CARDS */
        .stock-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem; }
        .stock-card { background: linear-gradient(145deg, #1a1a40 0%, #242850 100%); border: 2px solid #333; border-radius: 15px; padding: 1.5rem; cursor: pointer; transition: all 0.3s; }
        .stock-card:hover { border-color: #00d4ff; transform: translateY(-5px); }

        /* NEWSLETTER */
        .story-section { margin-bottom: 3rem; padding: 2rem; background: rgba(0, 212, 255, 0.05); border: 2px solid #00d4ff; border-radius: 15px; }
        .newsletter-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        .newsletter-table th { background: rgba(124, 58, 237, 0.3); color: #00d4ff; padding: 1rem; text-align: left; font-weight: 700; border: 1px solid #444; }
        .newsletter-table td { padding: 0.8rem 1rem; border: 1px solid #444; color: #b0b8c1; cursor: pointer; }
        .newsletter-table tr:hover { background: rgba(0, 212, 255, 0.1); }

        /* EA-STYLE RESEARCH PAGE LAYOUT */
        .stock-banner { background: linear-gradient(135deg, #7c3aed 0%, #06b6d4 100%); border-radius: 15px; padding: 2rem; margin-bottom: 1.5rem; }
        .stock-title { font-size: 3.5em; font-weight: 900; color: white; margin-bottom: 0.5rem; }
        .stock-subtitle { background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 10px; color: white; line-height: 1.6; }

        /* DUAL CHARTS SIDE BY SIDE */
        .charts-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
        .chart-card { background: rgba(26, 26, 64, 0.9); border: 2px solid #444; border-radius: 15px; padding: 1.5rem; }
        .chart-card h3 { color: #00d4ff; margin-bottom: 1rem; font-size: 1.2em; }
        .chart-box { height: 400px; width: 100%; }

        /* TECHNICAL + ENTRY BOXES */
        .info-boxes { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
        .info-box { background: rgba(26, 26, 64, 0.9); border: 2px solid #444; border-radius: 15px; padding: 1.5rem; }
        .info-box h3 { color: #00d4ff; margin-bottom: 1rem; font-size: 1.2em; }
        .info-content { color: #b0b8c1; line-height: 1.8; }

        /* AI DEEP ANALYSIS AT BOTTOM */
        .ai-deep-section { background: rgba(26, 26, 64, 0.9); border: 2px solid #00d4ff; border-radius: 15px; padding: 2rem; margin-bottom: 1.5rem; }
        .ai-deep-section h2 { color: #00d4ff; font-size: 1.8em; margin-bottom: 1rem; }
        .ai-deep-content { color: #d1fae5; line-height: 1.8; font-size: 1em; }

        @media (max-width: 1024px) {
            .charts-row, .info-boxes { grid-template-columns: 1fr; }
            .ai-chat-widget { width: calc(100% - 20px); right: 10px; left: 10px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo" onclick="goHome()">ðŸ“Š Elite Trading</div>
        <div class="search-bar">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Search ticker..." onkeypress="if(event.key=='Enter') searchStock()">
            <button onclick="searchStock()">ANALYZE</button>
        </div>
    </div>

    <button class="ai-chat-toggle" onclick="toggleAIChat()" id="aiChatToggle"><i class="fas fa-robot"></i></button>
    <div class="ai-chat-widget" id="aiChatWidget">
        <div class="ai-chat-header">
            <span>ðŸ¤– Trading AI</span>
            <button onclick="toggleAIChat()" style="background: none; border: none; color: white; font-size: 1.2em; cursor: pointer;">âœ•</button>
        </div>
        <div class="ai-messages" id="aiMessages">
            <div class="message ai">Ask about stocks, strategies, or market conditions.</div>
        </div>
        <div class="ai-input">
            <input type="text" id="aiInput" placeholder="Ask AI..." onkeypress="if(event.key=='Enter') sendAIMessage()">
            <button onclick="sendAIMessage()">Send</button>
        </div>
    </div>

    <!-- HOME PAGE -->
    <div id="homePage" class="page active">
        <div class="container">
            <div style="background: linear-gradient(135deg, #7c3aed 0%, #06b6d4 100%); border-radius: 20px; padding: 3rem 2rem; text-align: center; margin-bottom: 2rem;">
                <h1 style="font-size: 2.8em; font-weight: 900;">Elite Trading Analytics</h1>
                <p style="font-size: 1.1em;">57 Stocks Â· Live Prices Â· AI Analysis</p>
            </div>

            <div class="action-buttons">
                <button class="btn-large btn-refresh" onclick="loadAllStocks()"><i class="fas fa-sync"></i> LOAD 57 STOCKS</button>
                <button class="btn-large btn-brief" onclick="showBrief()"><i class="fas fa-bolt"></i> MARKET BRIEF</button>
                <button class="btn-large btn-newsletter" onclick="showNewsletter()"><i class="fas fa-newspaper"></i> NEWSLETTER SCREENER</button>
            </div>

            <div class="stock-grid" id="stockGrid">Click LOAD 57 STOCKS</div>
        </div>
    </div>

    <!-- MARKET BRIEF PAGE -->
    <div id="briefPage" class="page">
        <div class="container">
            <div style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 20px; padding: 3rem 2rem; text-align: center; margin-bottom: 2rem;">
                <h1 style="font-size: 2.8em; font-weight: 900;">ðŸ“Š Market Brief</h1>
            </div>

            <div class="story-section">
                <h2 style="color: #00d4ff; font-size: 1.8em; margin-bottom: 1rem;">ðŸ“ˆ Macro Summary</h2>
                <div style="color: #b0b8c1; line-height: 1.8;">
                    <strong>GDP Growth:</strong> +2.8% (Q3 2025)<br>
                    <strong>Unemployment:</strong> 3.9%<br>
                    <strong>Inflation (CPI):</strong> 3.2% YoY<br>
                    <strong>Fed Funds Rate:</strong> 5.25-5.50%<br>
                    <strong>10Y Treasury:</strong> 4.45%
                </div>
            </div>

            <div class="story-section">
                <h2 style="color: #00d4ff; font-size: 1.8em; margin-bottom: 1rem;">ðŸŽ¯ Micro Summary</h2>
                <div id="microSummary" style="color: #b0b8c1; line-height: 1.8;">Loading...</div>
            </div>

            <button class="btn-large btn-back" onclick="goHome()"><i class="fas fa-arrow-left"></i> BACK TO DASHBOARD</button>
        </div>
    </div>

    <!-- NEWSLETTER SCREENER PAGE -->
    <div id="newsletterPage" class="page">
        <div class="container">
            <div style="background: linear-gradient(135deg, #7c3aed 0%, #06b6d4 100%); border-radius: 20px; padding: 3rem 2rem; text-align: center; margin-bottom: 2rem;">
                <h1 style="font-size: 2.8em; font-weight: 900;">ðŸ“° Newsletter Screener</h1>
                <p>Stock Screening Newsletter - Institutional Analysis</p>
            </div>

            <div class="story-section" style="background: linear-gradient(135deg, rgba(124, 58, 237, 0.1) 0%, rgba(6, 182, 212, 0.05) 100%); border: 2px solid #7c3aed;">
                <h2 style="color: #7c3aed; font-size: 1.8em; margin-bottom: 1rem;"><i class="fas fa-brain"></i> AI Market Intelligence</h2>
                <div id="marketStory" style="color: #b0b8c1; line-height: 1.8;">Loading...</div>
            </div>

            <div class="story-section">
                <h2 style="color: #10b981; font-size: 1.8em; margin-bottom: 1rem;">VALUE SCREENING - Oversold Opportunities</h2>
                <table class="newsletter-table">
                    <thead><tr><th>Ticker</th><th>Price</th><th>Change</th><th>RSI</th><th>Regime</th><th>Inst</th><th>Signal</th><th>Action</th></tr></thead>
                    <tbody id="valueTable"><tr><td colspan="8">Loading...</td></tr></tbody>
                </table>
            </div>

            <div class="story-section">
                <h2 style="color: #10b981; font-size: 1.8em; margin-bottom: 1rem;">MOMENTUM ANALYSIS - Top Performers</h2>
                <table class="newsletter-table">
                    <thead><tr><th>Ticker</th><th>Price</th><th>5-Day %</th><th>RSI</th><th>Regime</th><th>Inst</th><th>Signal</th><th>Target</th></tr></thead>
                    <tbody id="momentumTable"><tr><td colspan="8">Loading...</td></tr></tbody>
                </table>
            </div>

            <button class="btn-large btn-back" onclick="goHome()"><i class="fas fa-arrow-left"></i> BACK TO DASHBOARD</button>
        </div>
    </div>

    <!-- RESEARCH PAGE - EA STYLE LAYOUT -->
    <div id="researchPage" class="page">
        <div class="container">
            <!-- 1. STOCK BANNER AT TOP -->
            <div class="stock-banner">
                <div class="stock-title" id="researchSymbol">TICKER</div>
                <div class="stock-subtitle" id="stockBrief">Loading stock analysis...</div>
            </div>

            <!-- 2. DUAL CHARTS SIDE BY SIDE -->
            <div class="charts-row">
                <div class="chart-card">
                    <h3>ðŸ“Š 1D Chart</h3>
                    <div id="chart1D" class="chart-box"></div>
                </div>
                <div class="chart-card">
                    <h3>ðŸ“Š 1W Chart</h3>
                    <div id="chart1W" class="chart-box"></div>
                </div>
            </div>

            <!-- 3. TECHNICAL SETUP + ENTRY & TARGETS BOXES -->
            <div class="info-boxes">
                <div class="info-box">
                    <h3>ðŸ”§ Technical Setup</h3>
                    <div class="info-content" id="technicalSetup">Loading...</div>
                </div>
                <div class="info-box">
                    <h3>ðŸŽ¯ Entry & Targets</h3>
                    <div class="info-content" id="entryTargets">Loading...</div>
                </div>
            </div>

            <!-- 4. AI DEEP ANALYSIS AT BOTTOM -->
            <div class="ai-deep-section">
                <h2><i class="fas fa-brain"></i> AI Deep Analysis</h2>
                <div class="ai-deep-content" id="aiDeepAnalysis">Loading comprehensive AI analysis...</div>
            </div>

            <!-- 5. BACK BUTTON AT VERY BOTTOM -->
            <button class="btn-large btn-back" onclick="goHome()"><i class="fas fa-arrow-left"></i> BACK TO DASHBOARD</button>
        </div>
    </div>

    <script>
        let allStocks = [
            {Symbol:'NVDA',Last:'178.88',Change:'-0.97',RSIWilder:'70',RegimeDetection:'82',Inst33:'85',Signal:'STRONG BUY'},
            {Symbol:'TSLA',Last:'342.80',Change:'-2.3',RSIWilder:'42',RegimeDetection:'50',Inst33:'60',Signal:'HOLD'},
            {Symbol:'META',Last:'512.15',Change:'2.1',RSIWilder:'66',RegimeDetection:'75',Inst33:'80',Signal:'BUY'},
            {Symbol:'AAPL',Last:'289.45',Change:'-1.15',RSIWilder:'52',RegimeDetection:'65',Inst33:'75',Signal:'HOLD'},
            {Symbol:'MSFT',Last:'425.30',Change:'0.85',RSIWilder:'58',RegimeDetection:'70',Inst33:'72',Signal:'BUY'},
            {Symbol:'GOOGL',Last:'178.50',Change:'-0.9',RSIWilder:'48',RegimeDetection:'55',Inst33:'68',Signal:'HOLD'},
            {Symbol:'AMZN',Last:'195.20',Change:'1.2',RSIWilder:'62',RegimeDetection:'72',Inst33:'70',Signal:'BUY'},
            {Symbol:'AMD',Last:'142.35',Change:'4.2',RSIWilder:'68',RegimeDetection:'78',Inst33:'65',Signal:'STRONG BUY'},
        ];

        function loadAllStocks() {
            const grid = allStocks.map(s => {
                const price = parseFloat(s.Last);
                const change = parseFloat(s.Change);
                return `
                    <div class="stock-card" onclick="researchStock('${s.Symbol}')">
                        <div style="font-size: 2.2em; font-weight: 900; color: white;">${s.Symbol}</div>
                        <div style="font-size: 1.8em; color: #00d4ff; font-weight: 900;">$${price.toFixed(2)}</div>
                        <div style="color: ${change >= 0 ? '#10b981' : '#ef4444'}; font-size: 1.1em; font-weight: 700; margin: 0.5rem 0;">
                            ${change >= 0 ? 'â–²' : 'â–¼'} ${Math.abs(change).toFixed(2)}%
                        </div>
                        <span style="display: inline-block; padding: 0.6rem 1.2rem; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 8px; font-weight: 700; color: white;">${s.Signal}</span>
                        <div style="margin-top: 1rem; font-size: 0.85em; color: #b0b8c1;">RSI: ${s.RSIWilder} | Regime: ${s.RegimeDetection}% | Inst: ${s.Inst33}</div>
                    </div>
                `;
            }).join('');
            document.getElementById('stockGrid').innerHTML = grid;
        }

        function showBrief() {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('briefPage').classList.add('active');

            const oversold = allStocks.filter(s => parseFloat(s.Change) < -2).length;
            const momentum = allStocks.filter(s => parseFloat(s.Change) > 3).length;

            document.getElementById('microSummary').innerHTML = `
                <strong>Market Sentiment:</strong> ${oversold > momentum ? 'Risk-off' : 'Risk-on'}<br>
                <strong>Oversold Stocks:</strong> ${oversold} mean reversion setups<br>
                <strong>Momentum Plays:</strong> ${momentum} breakout mode<br>
                <strong>Tech Sector:</strong> IV crush opportunities<br>
                <strong>VIX:</strong> 15.2 - complacency levels
            `;
        }

        function showNewsletter() {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('newsletterPage').classList.add('active');

            document.getElementById('marketStory').innerHTML = `
                <strong>Current Setup:</strong> ${allStocks.filter(s => parseFloat(s.Change) < -2).length} oversold, 
                ${allStocks.filter(s => parseFloat(s.Change) > 3).length} momentum.<br>
                <strong style="color: #00d4ff;">IV crush = buy opportunity.</strong> Scale on dips.
            `;

            const valueStocks = allStocks.filter(s => parseFloat(s.Change) < 0);
            document.getElementById('valueTable').innerHTML = valueStocks.map(s => `
                <tr onclick="researchStock('${s.Symbol}')">
                    <td><strong>${s.Symbol}</strong></td><td>$${parseFloat(s.Last).toFixed(2)}</td><td style="color: #ef4444;">${s.Change}%</td>
                    <td>${s.RSIWilder}</td><td>${s.RegimeDetection}%</td><td>${s.Inst33}</td><td>${s.Signal}</td>
                    <td style="color: #10b981;"><strong>BUY DIPS</strong></td>
                </tr>
            `).join('') || '<tr><td colspan="8">No oversold</td></tr>';

            const momentumStocks = allStocks.filter(s => parseFloat(s.Change) > 2);
            document.getElementById('momentumTable').innerHTML = momentumStocks.map(s => {
                const price = parseFloat(s.Last);
                return `
                    <tr onclick="researchStock('${s.Symbol}')">
                        <td><strong>${s.Symbol}</strong></td><td>$${price.toFixed(2)}</td><td style="color: #10b981;">+${s.Change}%</td>
                        <td>${s.RSIWilder}</td><td>${s.RegimeDetection}%</td><td>${s.Inst33}</td><td>${s.Signal}</td>
                        <td>$${Math.round(price * 1.1)}</td>
                    </tr>
                `;
            }).join('') || '<tr><td colspan="8">No momentum</td></tr>';
        }

        function researchStock(ticker) {
            const stock = allStocks.find(s => s.Symbol === ticker);
            if (!stock) return;

            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('researchPage').classList.add('active');

            const price = parseFloat(stock.Last);
            const change = parseFloat(stock.Change);

            // Stock Banner
            document.getElementById('researchSymbol').textContent = ticker;
            document.getElementById('stockBrief').innerHTML = `
                ${stock.Signal} | $${price.toFixed(2)} (${change}%)<br>
                ${change < -5 ? 'The Fade | SELL PREMIUM - Weakness detected near support ~$200.61. Consider bearish strategies.' : 
                  change > 5 ? 'The Setup | STRONG BUY - Bullish momentum with major moving averages support.' :
                  'The Consolidation | HOLD - Trading sideways, await confirmation.'}
            `;

            // Technical Setup
            document.getElementById('technicalSetup').innerHTML = `
                MACD: 12-close ${change > 0 ? 'bullish crossover' : 'bearish divergence'}<br>
                RSI: ${stock.RSIWilder} ${parseFloat(stock.RSIWilder) < 30 ? '(Oversold)' : parseFloat(stock.RSIWilder) > 70 ? '(Overbought)' : '(Neutral)'}<br>
                Regime Detection: ${stock.RegimeDetection}% trending strength<br>
                Key levels: Support $${Math.round(price * 0.95)} | Resistance $${Math.round(price * 1.05)}
            `;

            // Entry & Targets
            document.getElementById('entryTargets').innerHTML = `
                <strong>ENTRY:</strong> $${price.toFixed(2)}<br>
                <strong>T1 (5%):</strong> $${(price * 1.05).toFixed(2)}<br>
                <strong>T2 (10%):</strong> $${(price * 1.10).toFixed(2)}<br>
                <strong>STOP:</strong> $${(price * 0.95).toFixed(2)}
            `;

            // AI Deep Analysis
            document.getElementById('aiDeepAnalysis').innerHTML = `
                An Expert Advisor (EA) is an automated trading system that executes trades based on predefined rules, often derived from technical analysis indicators like moving averages, RSI, or MACD. 
                ${ticker} help traders eliminate emotional bias, increase efficiency, and consistently apply strategies across various assets such as forex, indices, and commodities. 
                They can be customized to suit individual risk tolerance, trading style, and market conditions, allowing for both simple and complex strategies, including trend-following, mean reversion, or multi-indicator confluence. 
                However, risks such as over-optimization, curve fitting, and adjustment to changing market environments are essential to maintain performance and adapt to real-time shifts in volatility, backtesting, and adjustment of parameters are essential to maintain performance.
            `;

            // Render Charts
            document.getElementById('chart1D').innerHTML = '';
            document.getElementById('chart1W').innerHTML = '';
            new TradingView.widget({container_id: "chart1D", width: "100%", height: "100%", symbol: ticker, interval: "D", timezone: "America/New_York", theme: "dark", style: "1", studies: ["BB@tv-basicstudies", "MACD@tv-basicstudies", "RSI@tv-basicstudies"]});
            new TradingView.widget({container_id: "chart1W", width: "100%", height: "100%", symbol: ticker, interval: "W", timezone: "America/New_York", theme: "dark", style: "1", studies: ["BB@tv-basicstudies", "MACD@tv-basicstudies"]});
        }

        function goHome() {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('homePage').classList.add('active');
        }

        function searchStock() {
            const ticker = document.getElementById('searchInput').value.toUpperCase().trim();
            if (ticker) {
                researchStock(ticker);
                document.getElementById('searchInput').value = '';
            }
        }

        function toggleAIChat() {
            const widget = document.getElementById('aiChatWidget');
            const toggle = document.getElementById('aiChatToggle');
            if (widget.classList.contains('active')) {
                widget.classList.remove('active');
                toggle.classList.remove('hidden');
            } else {
                widget.classList.add('active');
                toggle.classList.add('hidden');
            }
        }

        function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const msg = input.value.trim();
            if (!msg) return;
            const messagesDiv = document.getElementById('aiMessages');
            messagesDiv.innerHTML += `<div class="message user">${msg}</div>`;
            setTimeout(() => {
                const lowerMsg = msg.toLowerCase();
                let aiReply = lowerMsg.includes('nvda') ? 'NVDA at $178.88. RSI 70 = overbought. Pullback to $175 = entry.' : 
                              lowerMsg.includes('buy') ? 'Top buys: AMD (+4.2%), META (+2.1%).' : 
                              `Analyzing ${msg}... Check stock card.`;
                messagesDiv.innerHTML += `<div class="message ai">${aiReply}</div>`;
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }, 600);
            input.value = '';
        }

        window.addEventListener('load', loadAllStocks);
    </script>
</body>
</html>
